---
title: 'Reproducible scientific manuscripts with R Markdown'
date: 2021-04-01
permalink: /posts/2021/04/blog-post-2/
tags:
  - R Markdown
  - Reproducible science
---

An R Markdown template using `bookdown` to create reproducible scientific manuscripts with Microsoft Word

Reproducible scientific manuscripts
===========================

## Using R Markdown for writing manuscripts

There are many great resources for creating reproducible documents in R Markdown. 
Two packages in particular stand out: [`bookdown`](https://github.com/rstudio/bookdown) and [`papaja`](https://github.com/crsh/papaja).
`bookdown` is a flexible tool not only for creating books, but also documents of any kind that include cross-referencing.
`papaja` is specifically designed for APA formatting, which is used in my field.

I wanted to combine the strengths of both packages into a flexible template.
In particular, I wanted to create Microsoft Word documents using R Markdown that (a) already had the formatting I needed without a lot of post-output effort and (b) were also easily customized depending on the journal/audience.
While many journals accept LaTeX submissions, my collaborators typically rely on a Word-based workflow, and converting existing templates from tex to Word produces less than satisfactory results.
Existing templates for Word output were also not formatted for my needs and were not easily customized.
I developed [this template](https://github.com/hollzzar/manuscript-template) for creating scientific manuscripts that takes advantage of R Markdown's reproducibility, Word's ease of collaboration, and `bookdown`'s cross-referencing capabilities.

There are two main limitations to using Word outputs. 
One is that, to my knowledge, there is no way to include line numbers or update headers automatically.
This will need to be done in the Word document output.

More importantly, there is currently no way easy way to incorporate track-changes from collaborators.
I recommend using Git to compare your document to your collaborators' or using the *combine documents* functionality in Word.
Unfortunately, neither of these solutions updates your actual R Markdown documents.
This will need to be done by hand.

## Template organization

The R Markdown files and R scripts for the template are organized in a very hierarchical fashion.
This structure keeps the information tidy and concise at each stage, from data wrangling, analysis, and visualization to presentation/writing.

There are separate R Markdown files for each section:

- Title page
- Abstract
- Introduction
- Methods
- Results
- Conclusion/discussion
- Acknowledgements/funding

The formatting can be easily customized by changing the [Word document template](https://www.hzaharchuk.com/rmarkdown-guide/template.html#word-1) file or editing the [fenced code blocks](https://pandoc.org/MANUAL.html#fenced-code-blocks) in the Title page, Abstract, and Acknowledgements/funding files.
There is more information about using [`child` documents](https://www.hzaharchuk.com/rmarkdown-guide/organization.html#child-documents) and [source code](https://www.hzaharchuk.com/rmarkdown-guide/organization.html#source) in my [R Markdown Guide](https://www.hzaharchuk.com/rmarkdown-guide/).